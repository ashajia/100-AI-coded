# Excel 表格合并器

一个用于合并多个 Excel 文件的图形界面工具。

## 功能特点

- 支持拖放操作添加文件
- 可调整文件合并顺序
- 支持大文件处理
- 内存使用监控
- 智能的第一行处理机制
- 友好的进度显示

## 实现逻辑

### 文件处理
1. 支持通过拖放或点击添加按钮导入 Excel 文件
2. 文件列表支持拖动排序，决定最终合并顺序
3. 使用分块读取方式处理大文件，避免内存溢出

### 第一行处理
1. 提供两种第一行处理模式：
   - 只保留第一个文件的第一行（默认）
   - 保留所有文件的第一行
2. 当选择"只保留第一个文件的第一行"时：
   - 自动检查其他文件的第一行是否与第一个文件一致
   - 如发现不一致，会提示用户并允许选择是否继续合并

### 内存管理
1. 实时监控内存使用情况
2. 对大文件（>100MB）采用分块读取策略
3. 定期进行垃圾回收，优化内存使用

## 使用说明

### 基本操作
1. 添加文件：
   - 直接将文件拖放到程序窗口
   - 或点击"添加文件"按钮选择文件
2. 调整顺序：
   - 在文件列表中拖动文件可调整合并顺序
   - 从上到下的顺序即为最终合并顺序
3. 选择第一行处理方式：
   - 只保留第一个文件的第一行
   - 保留所有文件的第一行
4. 点击"开始合并"按钮开始处理

### 注意事项
1. 支持的文件格式：.xlsx, .xls
2. 建议先处理小文件测试效果
3. 当内存使用超过警戒值时会有颜色提示：
   - 橙色：超过 1.5GB
   - 红色：超过 3GB
4. 合并结果将保存在第一个文件所在目录
5. 如果目标文件已存在，会自动添加序号避免覆盖

### 错误处理
1. 如果文件第一行不一致：
   - 会显示警告信息
   - 可选择继续合并或取消操作
2. 合并过程中出错：
   - 会显示具体错误信息
   - 自动恢复界面可操作状态

## 系统要求

- Windows 操作系统
- Python 3.6 或更高版本
- 必要的 Python 包：
  - PyQt5
  - pandas
  - openpyxl
  - psutil